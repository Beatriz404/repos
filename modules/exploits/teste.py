from lib.thg.core.BaseXmodeClass.BaseMod import BaseMod
from lib.thg.core.BaseXmodeClass.BaseOption import BaseOption


class Exploit(BaseMod):
    def __init__(self):
        super(Exploit, self).__init__()
        self.update_info(
            {
                "name": "teste lib nome",
                "description": "teste lib descricao",
                "author": ["teste lib autor"],
                "references": [
                    "xxxxx1",
                    "xxxxx2",
                    "xxxxx3",
                    "xxxxx4",
                ],
                "disclosure_date": "teste lib data",
                "service_name": "teste lib nome servico",
                "service_version": "teste lib autor versao",
            }
        )
        self.register_http_target()
        self.register_options(
            [
                BaseOption(
                    name="teste", required=True, description="teste", value="teste"
                )
            ]
        )

    def check(self):
        url = self.options.get_option("URL/tcp")

    def exploit(self):

        url = self.options.get_option("URL/tcp")
        sql = self.options.get_option("teste")
