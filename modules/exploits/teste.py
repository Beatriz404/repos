import re
import requests
from THG.Model.Xmode.exploit.BaseExploit import BaseExploit
from THG.Model.BaseXmodeClass.BaseOption import BaseOption


class Exploit(BaseExploit):
    def __init__(self):
        super(Exploit, self).__init__()
        self.update_info({
            "name": "teste THG nome",
            "description": "teste THG descricao",
            "author": ["teste THG autor"],
            "references": [
                "xxxxx1",
                "xxxxx2",
                "xxxxx3",
                "xxxxx4",
            ],
            "disclosure_date": "teste THG data",
            "service_name": "teste THG nome servico",
            "service_version": "teste THG autor versao",
        })
        self.register_http_target()
        self.register_options([
            BaseOption(
                name="teste",
                required=True,
                description="teste",
                value="teste"
            )
        ])

    def check(self):
        url = self.options.get_option("URL/tcp")

    def exploit(self):

        url = self.options.get_option("URL/tcp")
        sql = self.options.get_option("teste")

