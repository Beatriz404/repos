##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

##
# This module requires lib: https://darkcode0x00.com/download
# Current source: https://github.com/darkcode357/thg-framework
##
from lib.thg.core.BaseXmodeClass.BaseMod import BaseMod
from lib.thg.core.BaseXmodeClass.BaseOption import BaseOption
from lib.thg.base.Interpreter.THGInterpreter import ThgInterpreter
from lib.thg.core_import import Darkcode0x00

thgcli = ThgInterpreter()


class Exploit(BaseMod):
    def __init__(self):
        super(Exploit, self).__init__()
        self.update_info(
            {
                "name": "handler.py",
                "description": """reverse shell programing.""",
                "author": [Darkcode0x00],
                "references": [
                    "darkcode0x00 pro",
                ],
                "disclosure_date": "2020, 10, 5",
                "service_name": "reverse shell",
                "service_version": "telegram send bot msg 0.1",
            }
        )
        self.register_options(
            [
                BaseOption(name="LPORT", required=True, description="LISTEN", value=""),
            ]
        )

    def check(self):
        Lport = self.options.get_option("LPORT")
        thgcli.runcmds_plus_hooks(
            ["""py from pwn import *""", """py cs =listen({})""".format(Lport)]
        )

    def exploit(self):
        port = self.options.get_option("LPORT")
